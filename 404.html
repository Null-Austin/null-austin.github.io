<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oopsies!</title>
    <link rel="stylesheet" href="https://unpkg.com/98.css" />
    <style>
      body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        
        display: flex;
        justify-content: center;  /* horizontal centering */
        align-items: center;      /* vertical centering */
        min-height: 100vh;        /* ensure body takes full viewport height */
        margin: 0;                /* remove default margin */

        background-image: url("/background.png");
        background-size: cover;
        background-repeat: no-repeat;
      }
    </style>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const previousBtn = document.querySelector("#previous");
        const homeBtn = document.querySelector("#home");

        const currentOrigin = window.location.origin;
        const referrer = document.referrer;

        // Debug without blocking the UI
        const debug = false;
        const log = (...args) => debug && console.log(...args);

        log("Page loaded");

        function safeRedirect(url) {
          window.location.assign(url);
        }

        // Setup Home button (always valid)
        homeBtn.disabled = false;
        homeBtn.addEventListener("click", () => safeRedirect("/"));

        // Setup Previous button
        if (!referrer) {
          previousBtn.innerText += " (None)";
          return;
        }

        let refUrl;
        try {
          refUrl = new URL(referrer);
        } catch {
          previousBtn.innerText += " (None)";
          return;
        }

        // Show something meaningful next to the button text
        // If same-origin, show path; otherwise show hostname
        const label = (refUrl.origin === currentOrigin)
          ? refUrl.pathname + refUrl.search + refUrl.hash
          : refUrl.hostname;

        previousBtn.innerText += ` (${label})`;
        previousBtn.disabled = false;

        previousBtn.addEventListener("click", () => {
          // If same-origin, go directly to the referrer URL
          if (refUrl.origin === currentOrigin) {
            safeRedirect(refUrl.href);
            return;
          }

          // Cross-origin referrers are often not desirable to bounce to.
          // Prefer history.back(); if it doesn't work, you still have Home.
          history.back();
        });
      });
    </script>
</head>
<body>
  <div id="main-window" class="window" style="width: 300px">
    <div class="title-bar">
      <div class="title-bar-text">Oopsies!</div>
      <div class="title-bar-controls">
        <button aria-label="Minimize"></button>
        <button aria-label="Maximize"></button>
        <button aria-label="Close"></button>
      </div>
    </div>
    <div class="window-body">
      <p>
        Yikes, there has been a error when trying to load the page.
        Feel free to buffer here for a second, or move on with the buttons below.
        </p>
        <button id="previous" disabled>Goto last page</button> <button id="home" disabled>Go home</button>
    </div>
  </div>
</body>
</html>